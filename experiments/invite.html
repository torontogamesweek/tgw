<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Invite a Friend - Toronto Games Week</title>

<link href="/styles.css" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css2?family=PT+Mono&display=swap" rel="stylesheet" />

<link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg" />
<link rel="shortcut icon" href="/favicon/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />

<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { background: #b8d8f0; }

  .invite-layout {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  @media (min-width: 800px) {
    .invite-layout {
      flex-direction: row;
      align-items: stretch;
      gap: 2rem;
    }
    .invite-form-side {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .invite-preview-side {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .preview-box {
      flex: 1;
    }
  }

  .invite-form-side label {
    display: block;
    margin-bottom: 0.3rem;
    font-weight: bold;
    font-size: 0.9rem;
  }

  .invite-form-side input,
  .invite-form-side textarea {
    font-family: 'PT Mono', monospace;
    font-size: 1rem;
    width: 100%;
    padding: 0.5rem;
    border: 2px solid #271b189c;
    border-radius: 5px;
    background: rgba(255,255,255,0.8);
    margin-bottom: 0.8rem;
  }

  .invite-form-side textarea {
    resize: vertical;
    min-height: 80px;
  }

  .char-count {
    font-family: 'PT Mono', monospace;
    font-size: 0.75rem;
    color: #271b189c;
    text-align: right;
    margin-top: -0.6rem;
    margin-bottom: 0.8rem;
  }

  .char-count.near-limit {
    color: #c0392b;
  }

  /* Verb shuffle row */
  .verb-row {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.8rem;
  }

  .verb-display {
    font-family: 'PT Mono', monospace;
    font-size: 1rem;
    flex: 1;
    padding: 0.5rem;
    border: 2px solid #271b189c;
    border-radius: 5px;
    background: rgba(255,255,255,0.8);
    text-align: center;
    min-height: 2.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
    overflow: hidden;
  }

  .verb-text {
    transition: opacity 0.15s, transform 0.15s;
  }

  .verb-text.rolling-out {
    opacity: 0;
    transform: translateY(-10px);
  }

  .verb-text.rolling-in {
    opacity: 0;
    transform: translateY(10px);
  }

  .shuffle-btn {
    font-family: 'PT Mono', monospace;
    font-size: 0.85rem;
    background: rgba(255,255,255,0.8);
    color: #271b18;
    border: 2px solid #271b189c;
    border-radius: 5px;
    padding: 0.5rem 0.7rem;
    cursor: pointer;
    flex-shrink: 0;
    transition: background 0.15s;
  }

  .shuffle-btn:hover {
    background: rgba(255,255,255,1);
  }

  .shuffle-btn:active {
    background: rgba(0,0,0,0.05);
  }

  /* Preview */
  .preview-label {
    font-size: 0.8rem;
    color: #271b189c;
    margin-bottom: 0.4rem;
  }

  .preview-box {
    border: 2px dashed #271b184d;
    border-radius: 5px;
    padding: 1.5rem;
    background: rgba(255,255,255,0.3);
    display: flex;
    flex-direction: column;
    gap: 0.15rem;
  }

  .preview-headline {
    font-size: 1.2rem;
    font-weight: bold;
    color: #271b18;
    line-height: 1.3;
  }

  .preview-reason {
    margin-top: 0.6rem;
    font-style: italic;
    font-weight: normal;
    font-size: 1rem;
    color: #271b18;
  }

  .preview-sig {
    margin-top: 0.5rem;
    font-size: 0.9rem;
    color: #271b189c;
  }

  .preview-placeholder {
    color: #271b184d;
  }

  .invite-btn-row {
    margin-top: 1rem;
    text-align: center;
  }
</style>
</head>

<body>
  <main>
    <div class="contentContainer">
      <div class="content">
        <section class="textBox">
          <h2>Invite a Friend to Toronto Games Week</h2>
          <p>Fill this out to create a personal invite link. When your friend opens it, the Toronto Games Week site will greet them with your message.</p>

          <br>

          <div class="invite-layout">

            <div class="invite-form-side">
              <label for="friend-name">Your Friend's Name</label>
              <input type="text" id="friend-name" placeholder="e.g. Sally" oninput="updatePreview()">

              <label>The summons</label>
              <div class="verb-row">
                <div class="verb-display" id="verb-display">
                  <span class="verb-text" id="verb-text">you've been summoned</span>
                </div>
                <button class="shuffle-btn" onclick="shuffleVerb()">shuffle</button>
              </div>

              <label for="personal-reason">Why should they come? <span style="font-weight:normal;color:#271b189c;">(optional)</span></label>
              <textarea id="personal-reason" placeholder="e.g. We need to play giant parachute games together!" oninput="updatePreview()" maxlength="150"></textarea>
              <div class="char-count" id="char-count">0 / 150</div>

              <label for="your-name">Your Name</label>
              <input type="text" id="your-name" placeholder="e.g. Marie" oninput="updatePreview()">
            </div>

            <div class="invite-preview-side">
              <p class="preview-label">Your friend will see:</p>
              <div class="preview-box">
                <div class="preview-headline" id="preview-headline"><span class="preview-placeholder">Friend</span>, you've been summoned to Toronto Games Week.</div>
                <div class="preview-reason" id="preview-reason" style="display:none;"></div>
                <div class="preview-sig" id="preview-sig">&mdash; <span class="preview-placeholder">You</span></div>
              </div>
            </div>

          </div>

          <div class="invite-btn-row">
            <p class="btn floatingBtn">
              <a href="#" onclick="generateAndCopy(); return false;" id="gen-btn">Generate &amp; Copy Invite Link</a>
            </p>
          </div>

        </section>
      </div>
    </div>
  </main>

<script>
var verbs = [
  "you've been summoned to",
  "you've been chosen, come to",
  "you've been dealt into",
  "you've unlocked an invite to",
  "this is your quest: come to",
  "it's your turn! Come to",
  "the dice have spoken. You're going to",
  "a wild invite appeared! Come to",
  "new quest unlocked: journey to",
  "the stars have aligned, come to",
  "plot twist! Come to",
  "you've levelled up! Next stop:",
  "ready or not, you're invited to"
];
var REASON_MAX = 150;
var currentVerbIndex = 0;

function shuffleVerb() {
  var textEl = document.getElementById('verb-text');
  textEl.classList.add('rolling-out');

  setTimeout(function() {
    currentVerbIndex = (currentVerbIndex + 1) % verbs.length;
    textEl.textContent = verbs[currentVerbIndex];
    textEl.classList.remove('rolling-out');
    textEl.classList.add('rolling-in');
    void textEl.offsetWidth;
    setTimeout(function() {
      textEl.classList.remove('rolling-in');
    }, 20);
    updatePreview();
  }, 150);
}

function buildHeadline(friend, verb) {
  if (verb.endsWith(':')) {
    return friend + ', ' + verb + ' Toronto Games Week.';
  }
  return friend + ', ' + verb + ' to Toronto Games Week.';
}

function updatePreview() {
  var from = document.getElementById('your-name').value.trim();
  var friend = document.getElementById('friend-name').value.trim();
  var reason = document.getElementById('personal-reason').value.trim();
  var verb = verbs[currentVerbIndex];

  // Character count
  var countEl = document.getElementById('char-count');
  var len = document.getElementById('personal-reason').value.length;
  countEl.textContent = len + ' / ' + REASON_MAX;
  if (len >= REASON_MAX - 10) {
    countEl.classList.add('near-limit');
  } else {
    countEl.classList.remove('near-limit');
  }

  // Headline (name + verb on one line)
  var headlineEl = document.getElementById('preview-headline');
  if (friend) {
    headlineEl.textContent = buildHeadline(friend, verb);
  } else {
    headlineEl.innerHTML = '<span class="preview-placeholder">Friend</span>, ' + (verb.endsWith(':') ? verb + ' Toronto Games Week.' : verb + ' to Toronto Games Week.');
  }

  // Reason â€” no quotation marks
  var reasonEl = document.getElementById('preview-reason');
  if (reason) {
    reasonEl.style.display = 'block';
    reasonEl.textContent = reason;
  } else {
    reasonEl.style.display = 'none';
  }

  // Signature
  var sigEl = document.getElementById('preview-sig');
  if (from) {
    sigEl.textContent = '\u2014 ' + from;
  } else {
    sigEl.innerHTML = '&mdash; <span class="preview-placeholder">You</span>';
  }
}

function generateAndCopy() {
  var from = document.getElementById('your-name').value.trim();
  var friend = document.getElementById('friend-name').value.trim();
  if (!from || !friend) { alert('Please fill in both names.'); return; }

  var data = {
    from: from,
    friend: friend,
    verb: verbs[currentVerbIndex],
    reason: document.getElementById('personal-reason').value.trim().slice(0, REASON_MAX)
  };

  var encoded = btoa(encodeURIComponent(JSON.stringify(data)));
  var url = 'https://torontogamesweek.com/experiments/experiments.html#invite=' + encoded;

  navigator.clipboard.writeText(url).then(function() {
    var btn = document.getElementById('gen-btn');
    btn.textContent = 'Link copied!';
    setTimeout(function() {
      btn.textContent = 'Generate & Copy Invite Link';
    }, 3000);
  });
}
</script>

</body>
</html>