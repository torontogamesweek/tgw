<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Toronto Games Week</title>

    <!-- Stylesheets -->
    <link href="../styles.css" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css2?family=PT+Mono&display=swap" rel="stylesheet" />

    <!-- Meta Tags -->
    <meta name="author" content="Marie Claire LeBlanc Flanagan" />
    <meta name="description" content="Celebrating games in Toronto, Canada" />

    <!-- Open Graph Tags -->
    <meta property="og:title" content="Toronto Games Week" />
    <meta property="og:description" content="Celebrating games in Toronto, Canada" />

    <meta property="og:image" content="https://torontogamesweek.com/images/TGW_Poster_Assets_2025/smPoster.png" />
    <meta property="og:url" content="https://torontogamesweek.com" />
    <meta property="og:type" content="webpage" />

    <!-- Twitter Tags -->
    <meta name="twitter:title" content="Toronto Games Week" />
    <meta name="twitter:description" content="Celebrating games in Toronto, Canada" />
    <meta name="twitter:image" content="https://torontogamesweek.com/images/TGW_Poster_Assets_2025/smPoster.png" id="indexImage" />
    <meta name="twitter:card" content="summary_large_image" />

    <!-- Image Specifications -->
    <meta
      property="og:image:alt"
      content="Poster for TGW - an illustration of a magical city with many tiny elements related to Toronto like a racoon, the TTC, and the beach" />

    <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg" />
    <link rel="shortcut icon" href="/favicon/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />
    <link rel="manifest" href="/favicon/site.webmanifest" />

    <style>
      /* Base canvas setup */
      canvas {
        position: absolute; /* Mobile default */
        width: 100%;
        background-image: none;
        height: auto;
        left: 0;
        top: 0;
      }

      .image-container {
        position: relative;
        top: 0;
        left: 0;
        width: 100%;
        height: calc(1000px * (9 / 16)); /* Assuming 16:9 aspect ratio, adjust to match actual image ratio */
      }

      .gcal-icon {
        position: absolute;
        top: 1rem;
        right: 1rem;

        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.5rem;
        text-decoration: none;
        z-index: 10;
        border-radius: 50%;
        padding: 1rem;
        border: 2px solid #c0d4e9;
        background-color: rgba(248, 251, 255, 0.81);
        color: #4285f4;
        cursor: pointer;
        transition: all 0.3s ease;

        width: 3rem;
        height: 3rem;
      }

      /* Hover state */
      .gcal-icon:hover {
        background-color: #c0d4e9;
        color: white;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        transform: translateY(-2px);
      }

      /* Focus state for accessibility */
      .gcal-icon:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.4);
      }

      main {
        position: relative;
        z-index: 1;
        margin-top: 0;
        background-color: none;

        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 2rem;
        padding: 10px 5px;
        background-image: url("images/TGW_Poster_Assets_2025/clouds.png");
        background-repeat: repeat-y;
        background-position: center top;
        background-size: 100% auto;
        background-attachment: fixed;
      }

      header {
        margin-top: 0;
      }

      #linkBold2025 {
        font-weight: bold;
        color: #5f32f3;
      }

      #main2025 {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 2rem;
        padding: 10px 5px;
        background-image: url("images/TGW_Poster_Assets_2025/clouds.png");
        background-repeat: repeat-y;
        background-position: center top;
        background-size: 100% auto;
        background-attachment: fixed;
      }

      @media (min-width: 768px) {
        #main2025 {
          /* padding: 0 2rem 8rem ; */
        }
      }

      #topboxcontainer2025 {
        /* margin-top: 15rem; */
        /* margin: 0 2px; */
      }

      @media (min-width: 768px) {
        #topboxcontainer2025 {
          /* margin: 0 15rem; */
        }
      }

      #topbox2025 {
        font-size: 1.5rem;
        padding-top: 20px;
        opacity: 1;
        width: 100vw;
      }

      #primary-navigation {
        /* z-index: 50; */
      }

      .contentContainer {
        position: relative;
        z-index: 1;
      }

      /* Content container setup */
      .contentContainer,
      .sponsorBox {
        position: relative;
        z-index: 1;
        pointer-events: none;
      }

      .headerImgDiv {
        z-index: 1;
        pointer-events: none;
        background-color: transparent;
      }

      /* Main content areas */
      .content {
        pointer-events: none;
      }

      .textBox2025 {
        /* max-width: 85vw; */
        position: relative;
        min-width: 100%;
        display: flex;
        flex-direction: column;
        margin: 0 auto 0 auto;
        /* padding: 1.5rem; */
        /* padding: 0 2rem 2rem 3rem; */
        padding: 0;
        border-radius: 10px;
        background-color: hsla(0, 0%, 100%, 0.9);
        pointer-events: none;
        text-align: center;
        align-items: center;
        /* max-width: 98vw; */
        /* padding: 4rem 10rem; */
      }

      @media (min-width: 768px) {
        .textBox2025 {
          padding: 8rem 2rem;
          padding: 0;
        }
      }

      button:hover {
        /* expand a bit */
        transform: scale(1.1);
        transition: transform 0.2s ease-in-out;
      }

      .categoryContainer2025 {
        margin: 1rem 0 0;
      }

      .category2025 {
        text-transform: lowercase;
        /* margin: 2rem 0 1rem 1rem; */
        background: rgba(221, 213, 230, 0.9);
        color: #5f32f3;
        padding: 0.15rem 0.3rem;
        border-radius: 13px;
        font-size: 0.9rem;
        display: inline-block; /* keep the background color wrapped tight */
        font-family: "Alegreya", sans-serif;
        margin: 0.25rem 0.25rem;
      }

      #daySelector {
        width: 100%;
        display: flex;
        flex-direction: row;
        justify-content: space-evenly;
      }

      @media (min-width: 768px) {
        #daySelector {
          justify-content: center;
        }
      }

      #daySelectorSelected {
        background-color: rgba(218, 194, 247, 0.3);
        color: #bbbbbb;
        font-weight: bold;
      }

      .weekendColorOne {
        /* light-medium blue */
        background-color: #4c8bb8;
      }

      .weekendColorTwo {
        /* Deep Blue */
        /* background-color: #045888; */
        background-color: #4c8bb8;
      }

      .weekendColorThree {
        /* Medium Blue */
        background-color: #4f8cc9;
      }

      .saveEvent {
        background-color: #4c8bb8;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1rem;
        /* Fix to top right */
        position: absolute;
        top: 1rem;
        right: 1rem;
      }

      #img2025 {
        max-height: 8rem;
      }

      #title2025 {
        font-size: 2rem;
      }

      #description2025 {
        font-size: 1rem;
      }

      a {
        font-size: 1rem;
      }

      p {
        font-size: 1rem;
      }

      #schedule-container {
        width: 100%;
      }

      @media (min-width: 768px) {
        #schedule-container {
          /* 3 per row in the grid with them all the same size */
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
          gap: 2rem;
        }
      }

      #date2025 {
        font-size: 1.5rem;
        font-weight: bold;
      }

      @media (min-width: 768px) {
        .textBox2025 {
          /* padding: 4rem 10rem; */
        }
      }

      /* Re-enable pointer events for specific interactive elements */
      .contentContainer > * .headerImgDiv img,
      .btn,
      .floatingBtn,
      .textBox2025 > * {
        pointer-events: all;
        z-index: 2;
      }

      #allDaysButton {
        background-color: #800077;
        color: white;
      }

      /* Header */
      nav {
        /* position: static; */
      }

      nav a {
        pointer-events: auto;
        background-color: white;
      }

      nav ul {
        background-color: rgb(255, 255, 255);
      }

      @media screen and (min-width: 900px) {
      }

      @media (min-width: 768px) {
        header {
          height: 0;
        }

        canvas {
          position: absolute; /* Reset for desktop */
        }

        nav li,
        nav ul,
        nav {
          background-color: rgba(255, 255, 255, 0);
          padding: 10px 10px 0 10px;
        }

        nav {
          margin: 0;
          padding: 0;
          background-color: rgba(255, 255, 255, 0);
        }
        nav a {
          color: rgb(45, 45, 45); /* Adjust based on background */
          text-shadow: 0 0 5px white; /* Soft glow effect */
          background-color: rgba(255, 255, 255, 0);
        }

        nav > ul > li {
          font-size: 1.5rem;
          margin: 0 10px;
        }

        header {
          position: relative;
        }
      }

      .logo-container {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 1rem;
        justify-items: center;
        align-items: center;
        min-height: 120px;
        max-width: 97rem;
        width: 100%;
      }

      .logo-slot {
        width: 100%;
        height: 140px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .logo-slot a {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
      }

      .logo {
        width: 80px; /* Smaller for mobile */
        height: 50px; /* Smaller for mobile */
        object-fit: contain;
        opacity: 0;
        transition: opacity 1.2s ease-in-out;
        pointer-events: auto;
        background-color: rgba(255, 255, 255);
        border-radius: 5px;
        padding: 0.3rem 0.5rem; /* Less padding on mobile */
        border: 1px dotted var(--white);
      }

      .logo-big {
        width: 80px; /* Same size for consistency */
        height: 50px;
      }

      /* Make them bigger on desktop while keeping them uniform */
      @media (min-width: 768px) {
        .logo-slot {
          width: 100%;
          height: 180px;
        }

        .logo,
        .logo-big {
          width: 160px; /* Bigger but uniform width */
          height: 120px; /* Bigger but uniform height */
          padding: 0.5rem 1rem; /* More padding on desktop */
          border: 2px solid #271b189c; /* Thicker border on desktop */
        }
      }

      .logo.visible {
        opacity: 1;
      }

      /* Mobile styles */
      @media (max-width: 768px) {
        .sponsorbox {
          margin: 0;
        }

        .logo-container {
          grid-template-columns: repeat(3, 1fr);
          gap: 5px;
        }

        /* Hide slots 4-6 on mobile */
        .logo-slot:nth-child(n + 4) {
          display: none;
        }
      }

      .no-pointer-events {
        pointer-events: none;
      }

      /* Base */
      main {
        position: relative;
        z-index: 1;
      }
    </style>
  </head>

  <body>
    <header>
      <button id="nav-toggle" aria-expanded="false" aria-controls="primary-navigation" class="nav-toggle-button">
        <span class="sr-only">Menu</span>
        <span class="icon"></span>
      </button>

      <nav id="primary-navigation">
        <ul>
          <li>
            <a href="./index.html">Home</a>
          </li>
          <li>
            <a href="schedule.html" id="scheduleNav">Schedule</a>
          </li>
          <li>
            <a href="about.html" id="aboutNav">About</a>
          </li>
        </ul>
      </nav>
    </header>

    <main class="no-pointer-events" id="main2025">
      <!-- Add HTML here -->

      <div class="headerImgDiv">
        <img id="letterImg" src="/images/TGW_Poster_Assets_2025/Logo.png" alt="A type treatment of Toronto Games Week" />
        <!-- <p id="caption">A celebration of playable arts & culture</p> -->
        <br />
        <br />
      </div>

      <div id="topboxcontainer2025">
        <section class="textBox2025" id="topbox2025">
          <h2>Toronto Games Week Schedule (June 12-18, 2025)</h2>
          <p>Come explore the many events, gatherings, and happenings of Toronto Games Week 2025!</p>
          <p>
            You can add the full schedule to your calendar (<a href="https://calendar.google.com/calendar/u/0/r?cid=torontogamesweek@gmail.com"
              >Gcal link</a
            >) or add individual events using the calendar icons.
          </p>
          <p>Use the buttons below to check out specific days!</p>
          <section class="textBox-btn" id="daySelector">
            <button role="button" href="#day1" class="btn-d1 weekendColorOne" data-day="Thu 12">
              Th<br />
              12
            </button>
            <button role="button" href="#day2" class="btn-d2 weekendColorOne" data-day="Fri 13">Fr<br />13</button>
            <button role="button" href="#day3" class="btn-d3 weekendColorTwo" data-day="Sat 14">Sa<br />14</button>
            <button role="button" href="#day4" class="btn-d4 weekendColorTwo" data-day="Sun 15">Su<br />15</button>
            <button role="button" href="#day5" class="btn-d5 weekendColorThree" data-day="Mon 16">Mo<br />16</button>
            <button role="button" href="#day6" class="btn-d6 weekendColorThree" data-day="Tue 17">Tu<br />17</button>
            <button role="button" href="#day7" class="btn-d7 weekendColorThree" data-day="Wed 18">We<br />18</button>

            <button role="button" class="btn-d1 btn-all weekendColorThree" data-day="All" id="allDaysButton">All<br />Days</button>
          </section>
        </section>
      </div>
      <div id="schedule-container"></div>

      <div class="sponsorbox">
        <div class="logo-container">
          <div class="logo-slot"></div>
          <div class="logo-slot"></div>
          <div class="logo-slot"></div>
          <div class="logo-slot"></div>
          <div class="logo-slot"></div>
          <div class="logo-slot"></div>
        </div>
      </div>

      <div class="logo-source" style="display: none">
        <a href="https://www.ontariocreates.ca/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Ontario-Creates.png" alt="Ontario Creates logo" class="logo logo-big" />
        </a>
        <a href="https://www.toronto.ca/business-economy/industry-sector-support/creative-technology/" target="blank">
          <img src="images/logos/2025/TGW25-Web_City-of-Toronto.png" alt="City of Toronto logo" class="logo logo-big" /> </a
        ><br />
        <a href="https://www.drinkboxstudios.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Drinkbox-Studios.png" alt="Drinkbox Studios logo" class="logo logo-big" />
        </a>

        <a href="https://www.resolume.com/" target="blank"><img src="images/logos/resolume.png" alt="Resolume logo" class="logo logo-big" /></a>

        <a href="https://www.epicgames.com/site/en-US/home" target="blank">
          <img src="images/logos/2025/TGW25-Web_Epic-Games.png" alt="Epic Games logo" class="logo logo-big" />
        </a>
        <a href="https://gameartsinternational.network/" target="blank">
          <img src="images/logos/2025/TGW25-Web_GAIN.png" alt="GAIN logo" class="logo logo-big" />
        </a>
        <a href="https://www.interactiveontario.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Interactive-Ontario.png" alt="Interactive Ontario logo" class="logo logo-big" />
        </a>
        <a href="https://xpgamesummit.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_XP-Gaming.png" alt="XP Gaming logo" class="logo logo-big" />
        </a>
        <a href="https://brokengamescollective.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Broken-Games-Collective.png" alt="Broken Games Collective logo" class="logo logo-big" />
        </a>
        <a href="https://makerspace.cobot.me/" target="blank">
          <img src="images/logos/2025/TGW25-Web_TTL-Makerspace.png" alt="TTL Makerspace logo" class="logo logo-big" />
        </a>
        <a href="https://linktr.ee/bonusstagetoronto/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Bonus-Stage.png" alt="Bonus Stage logo" class="logo logo-big" />
        </a>
        <a href="https://ladyarcaders.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Lady-Arcaders.png" alt="Lady Arcaders logo" class="logo logo-big" />
        </a>
        <a href="https://vividfoundry.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Vivid-Foundry.png" alt="Vivid Foundry logo" class="logo logo-big" />
        </a>
        <a href="https://www.dirty-rectangles.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Dirty-Rectangles.png" alt="Dirty Rectangles logo" class="logo logo-big" />
        </a>
        <a href="https://tojam.ca/" target="blank">
          <img src="images/logos/2025/TGW25-Web_TO-Jam.png" alt="Toronto Game Jam logo" class="logo logo-big" />
        </a>
        <a href="https://torontopubliclibrary.ca/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Toronto-Public-Library.png" alt="Toronto Public Library logo" class="logo logo-big" />
        </a>
        <a href="https://interaccess.ca/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Interaccess.png" alt="Interaccess logo" class="logo logo-big" />
        </a>
        <a href="https://werocreative.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_wero.png" alt="Wero logo" class="logo logo-big" />
        </a>
        <a href="https://unity.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Unity-Color.png" alt="Unity logo" class="logo logo-big" />
        </a>
        <a href="https://www.amd.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_AMD.png" alt="AMD logo" class="logo logo-big" />
        </a>
        <a href="https://www.rom.on.ca/" target="blank">
          <img src="images/logos/2025/TGW25-Web_ROM.png" alt="ROM logo" class="logo logo-big" />
        </a>
        <a href="https://kittencupstudio.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Kitten-Cup-Studio.png" alt="Kitten Cup Studio logo" class="logo logo-big" />
        </a>
        <a href="https://www.finji.co/" target="blank">
          <img src="images/logos/2025/TGW25-Web_FINJI.png" alt="FINJI logo" class="logo logo-big" />
        </a>
        <a href="https://gamerella.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_GAMERella.png" alt="GAMERella logo" class="logo logo-big" />
        </a>
        <a href="https://igda.org/" target="blank">
          <img src="images/logos/2025/TGW25-Web_IGDA.png" alt="IGDA logo" class="logo logo-big" />
        </a>
        <a href="https://handeyesociety.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Hand-Eye-Society.png" alt="Hand Eye Society logo" class="logo logo-big" />
        </a>
        <a href="https://www.georgebrown.ca/" target="blank">
          <img src="images/logos/2025/TGW25-Web_George-Brown-College.png" alt="George Brown College logo" class="logo logo-big" />
        </a>
        <a href="" target="blank">
          <img src="images/logos/2025/TGW25-Web_GRID.png" alt="GRID logo" class="logo logo-big" />
        </a>
        <a href="https://cwacanada.ca/" target="blank">
          <img src="images/logos/2025/TGW25-Web_CODE-CWA.png" alt="CODE CWA logo" class="logo logo-big" />
        </a>
        <a href="https://www.anotherstory.ca/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Another-Story-Bookshop.png" alt="Another Story Bookshop logo" class="logo logo-big" />
        </a>
        <a href="https://www.trinitysquarevideo.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Trinity-Square-Video.png" alt="Trinity Square Video logo" class="logo logo-big" />
        </a>
        <a href="https://www.lockwoodimmersive.com/" target="blank">
          <img src="images/logos/2025/TGW25-Web_Lockwood-Immersive.png" alt="Lockwood Immersive logo" class="logo logo-big" />
        </a>
      </div>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const navToggle = document.getElementById("nav-toggle");
        const primaryNav = document.getElementById("primary-navigation");

        navToggle.addEventListener("click", function () {
          const isExpanded = navToggle.getAttribute("aria-expanded") === "true";
          navToggle.setAttribute("aria-expanded", !isExpanded);
          primaryNav.classList.toggle("expanded");
        });
      });
    </script>
    <script>
      // Add Javascript Here

      // Parse CSV with proper handling of newlines in quoted fields
      const parseCSV = (csvText) => {
        const result = [];
        let row = [];
        let currentValue = "";
        let insideQuotes = false;

        for (let i = 0; i < csvText.length; i++) {
          const char = csvText[i];
          const nextChar = csvText[i + 1];

          if (char === '"' && (!insideQuotes || nextChar !== '"')) {
            // Toggle quote state (but not for escaped quotes)
            insideQuotes = !insideQuotes;
            continue;
          }

          if (char === '"' && nextChar === '"') {
            // Handle escaped quotes (double quotes)
            currentValue += '"';
            i++; // Skip the next quote
            continue;
          }

          if (char === ";" && !insideQuotes) {
            // End of field
            row.push(currentValue);
            currentValue = "";
            continue;
          }

          if ((char === "\n" || (char === "\r" && nextChar === "\n")) && !insideQuotes) {
            // End of row
            row.push(currentValue);
            result.push(row);
            row = [];
            currentValue = "";
            if (char === "\r") i++; // Skip \n if we encountered \r\n
            continue;
          }

          // Regular character, add to current value
          currentValue += char;
        }

        // Don't forget the last row/value if file doesn't end with newline
        if (currentValue !== "" || row.length > 0) {
          row.push(currentValue);
          result.push(row);
        }

        return result;
      };

      class Event {
        constructor(name, hook, description, date, location, linkInfo, link, startTime, endTime, icon, iconAlt, categories, gcalLink) {
          this.name = name;
          this.hook = hook;
          this.description = description;
          this.date = date;
          this.location = location;
          this.linkInfo = linkInfo;
          this.link = link;
          this.startTime = startTime;
          this.endTime = endTime;
          this.icon = icon;
          this.iconAlt = iconAlt;
          this.categories = categories;
          this.gcalLink = gcalLink;
        }
      }

      const events = [];
      const SHEET_ID = "1nfs459EuPLSICm9QbCI9EcQoyJ9T6hfXQPzogEYaW_4";
      const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv`;

      // Helper function to convert row to object
      function rowToObject(headers, row) {
        const obj = {};
        headers.forEach((header, index) => {
          obj[header.trim()] = row[index] || "";
        });
        return obj;
      }

      async function fetchSheetData() {
        try {
          const response = await fetch(SHEET_URL);
          const csvText = await response.text();
          let semicolonCsv = csvText.replace(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/g, ";");

          const rows = parseCSV(semicolonCsv);
          if (rows.length === 0) return [];

          const headers = rows[0].map((header) => header.trim());

          // Process data rows
          for (let i = 1; i < rows.length; i++) {
            const rowData = rowToObject(headers, rows[i]);

            const name = rowData["Event Name"] || "";
            const hook = rowData["The hook!"] || "";
            const description = rowData["Short Event Description"] || "";
            const date = rowData["Event Date (start)"] || "";
            const location = rowData["Event Venue"] || "";
            const linkInfo = rowData["Ticket / Pricing Details"] || "";
            const link = rowData["Event link"] || "";
            const incomplete = rowData["Status"];
            const startTime = rowData["Event Time"];
            const endTime = rowData["Event End Time"];
            const icon = rowData["Icon"];
            const iconAlt = rowData["Alttext"];
            const categories = rowData["Target Audience"] ? rowData["Target Audience"].split(",") : [];
            const gcalLink = rowData["BAD CAL (v2)"] || "";

            if (incomplete !== "Live") continue;
            if (events.some((event) => event.name === name)) {
              const existingEvent = events.find((event) => event.name === name);
              existingEvent.date += `, ${date}`;
              continue;
            }
            if (!name || name === "Incomplete") continue;

            events.push(new Event(name, hook, description, date, location, linkInfo, link, startTime, endTime, icon, iconAlt, categories, gcalLink));
          }

          return events;
        } catch (error) {
          console.error("Error fetching sheet data:", error);
          return [];
        }
      }

      let currentDisplayingEvents = events;
      function displayEvents(events) {
        if (!events) {
          events = currentDisplayingEvents;
        } else {
          currentDisplayingEvents = events; // Update the current displaying events
        }

        const container = document.getElementById("schedule-container");
        container.innerHTML = ""; // Clear previous content

        events.forEach((event) => {
          const eventDiv = document.createElement("div");
          eventDiv.className = "event";

          eventDiv.innerHTML = `
            <section class="textBox2025">
              
              <img id="img2025" src="/images/TGW_Poster_Assets_2025/${event.icon}" alt="${event.icon}" class="eventIcon" />
              <h3 class="date" id="date2025">${event.date}, ${event.startTime}-${event.endTime}</h3> 
              ${
                event.gcalLink
                  ? `<a href="${event.gcalLink}" target="_blank" class="gcal-icon" title="Add to Google Calendar" aria-label="Add to Google Calendar">📅</a>`
                  : ""
              }
             
      
              <div class="DescAndImg">
                <div class="desc">
                  <h2 class="title" id="title2025">${event.name}</h2>
                  <p class="details" id="description2025">
                    ${event.description}

                    <span id="linkBold2025"> ${event.link ? `<a href="${event.link}" target="_blank">${event.linkInfo}</a>` : `${event.linkInfo}`}
                    </span>
                  </p>
                </div>
              </div>

              <p class="location"><span aria-hidden="true">📍</span>
                <a href="https://www.google.com/maps/search/${encodeURIComponent(event.location)}" 
                  target="_blank" 
                  title="View on Google Maps">
                  ${event.location}
                </a>
              </p>

              <p class="categoryContainer2025">
                ${event.categories
                  ?.map((category) => {
                    return `<span class="category2025">${category}</span>`;
                  })
                  .join("")}
                
              </p>
              
            </section>
          `;
          container.appendChild(eventDiv);
        });

        registerSaveEventButtons(); // Re-register buttons to ensure they work after DOM update
      }

      function registerDaySelectors() {
        // Add event listeners to buttons
        const buttons = document.querySelectorAll("[role='button']");
        buttons.forEach((button) => {
          button.addEventListener("click", (event) => {
            // Prevent default link behavior
            event.preventDefault();

            // Remove selected styling from all buttons
            buttons.forEach((btn) => {
              btn.style.border = "none";
              btn.style.outline = "none";
            });

            // Set selected styling to the clicked button
            event.currentTarget.style.border = "2px solid white";
            event.currentTarget.style.outline = "2px solid #4f8cc9";

            // Check if this is the All Days button
            const day = event.currentTarget.getAttribute("data-day");
            if (day === "All") {
              // Show all events
              displayEvents(events);
              return;
            }

            // Otherwise, filter by the selected day
            const dayShort = day.split(" ")[0];
            const targetId = `#day${dayShort}`;
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
              targetElement.scrollIntoView({ behavior: "smooth" });
            }

            // Rerender events for the selected day
            const filteredEvents = events.filter((event) => event.date.includes(dayShort));

            displayEvents(filteredEvents);
          });
        });

        // Set All Days button as selected by default
        const allDaysButton = document.querySelector("[data-day='All']");
        if (allDaysButton) {
          allDaysButton.style.border = "3px solid white";
          allDaysButton.style.outline = "6px solid #5f32f3";
        }
      }

      function registerSaveEventButtons() {
        const saveButtons = document.querySelectorAll("button.saveEvent");
        // Remove existing listeners to avoid duplicates
        saveButtons.forEach((button) => {
          button.removeEventListener("click", () => {});
        });

        saveButtons.forEach((button) => {
          button.addEventListener("click", (event) => {
            const eventName = event.currentTarget.getAttribute("data-event-name");

            const savedEvents = localStorage.getItem("savedEvents") ? JSON.parse(localStorage.getItem("savedEvents")) : [];

            if (savedEvents.includes(eventName)) {
              savedEvents.splice(savedEvents.indexOf(eventName), 1);
              localStorage.setItem("savedEvents", JSON.stringify(savedEvents));
            } else {
              savedEvents.push(eventName);
              localStorage.setItem("savedEvents", JSON.stringify(savedEvents));
            }

            displayEvents(); // Rerender events to reflect changes
            registerSaveEventButtons(); // Re-register buttons to ensure they work after DOM update
          });
        });
      }

      function showSavedEvents() {
        const savedEvents = localStorage.getItem("savedEvents") ? JSON.parse(localStorage.getItem("savedEvents")) : [];

        if (savedEvents.length === 0) {
          const saveEventButton = document.getElementById("showSavedEvents");
          return;
        }

        const filteredEvents = events.filter((event) => savedEvents.includes(event.name));

        displayEvents(filteredEvents);
      }

      function handleLoaded() {
        fetchSheetData()
          .then((events) => {
            displayEvents(events);
            registerDaySelectors();
            registerSaveEventButtons();

            // const saveEventButton = document.getElementById("showSavedEvents");
            // saveEventButton.addEventListener("click", (event) => {
            //   event.preventDefault(); // Prevent default link behavior
            //   showSavedEvents();
            // });
          })
          .catch((error) => {
            console.error("Error displaying events:", error);
          });
      }

      // Call the function when the page loads
      document.addEventListener("DOMContentLoaded", handleLoaded);
    </script>

    <script>
      function setupSponsors() {
        const slots = document.querySelectorAll(".logo-slot");
        const logos = [...document.querySelectorAll(".logo-source a")];

        function getVisibleCount() {
          return window.innerWidth <= 768 ? 3 : 6; // 3 on mobile, 6 on desktop
        }

        function updateLogos() {
          const visibleCount = getVisibleCount();
          const selectedLogos = [...logos].sort(() => Math.random() - 0.5).slice(0, visibleCount);

          // First fade out current logos
          slots.forEach((slot) => {
            const currentLogo = slot.querySelector("img");
            if (currentLogo) {
              currentLogo.classList.remove("visible");
            }
          });

          setTimeout(() => {
            slots.forEach((slot, i) => {
              if (selectedLogos[i]) {
                const logo = selectedLogos[i].cloneNode(true);
                slot.innerHTML = "";
                slot.appendChild(logo);
                requestAnimationFrame(() => {
                  logo.querySelector("img").classList.add("visible");
                });
              }
            });
          }, 1200);
        }

        updateLogos();
        setInterval(updateLogos, 6000);

        window.addEventListener(
          "resize",
          debounce(() => {
            updateLogos();
          }, 250)
        );
      }

      document.addEventListener("DOMContentLoaded", setupSponsors);
    </script>
  </body>
</html>
